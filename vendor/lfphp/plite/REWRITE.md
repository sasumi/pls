# PLITE URL rewriting rules

## 1. Introduction

Route rewriting includes two functions:

① Access route identification (such as when a user accesses `/user.html`, it can correctly identify `controller/action`

② Generate route rewriting rules (such as in the code, `<?php echo url("user/index");?>` can generate `/user.html` url string)

In step ①, the access route identification is identified by the function: `rewrite_resolve_path($mapping, $pathinfo);` and automatically set as the current route (this step needs to be done before the route takes effect). In step ②, the rewrite rule URL is generated by the `rewrite_bind_url($mapping)` function. URL generation and rewriting are achieved by binding the event `EVENT_ROUTER_URL` in the `url($uri, $p)` function. The two steps are integrated and called uniformly through the function `rewrite_setup($mapping)`.

Note: Generally, the CLI call mode is less `url()` Call requirements. If you need to bind the URL generation rules in the corresponding script, please manually call the `rewrite_bind_url()` function.

## 2. Rule configuration

Configuration rules:

```php
[
//URL matching pattern uri pattern (supports placeholder patterns such as $1 and ￥2), data key data value (supports placeholder patterns such as $1 and ￥2)
'url_pattern' => ['uri_pattern', ['arg_key'=>'val_pattern']],
]
```

Actual configuration example:
```php
<?php
$mapping = [
# /course/detail_234234.html Course details
'detail_{w}.html' => ['course/detail', ['resource_id' => '$1']],

# /course/tag1/tag2.html Secondary tag
'catalog/{w}/{w}.html' => ['course/catalog', ['t1' => '$1', 't2' => '$2']],

# /course/tag1.html First-level tag
'catalog/{w}.html' => ['course/catalog', ['t1' => '$1']],

# /course/p_234234.html Course details
'search.html' => ['course/search'],

'{w}.html' => ['page/$1'],

'{w}/{w}.html' => ['$1/$2', ['pp' => '$1']],
]

```

## 3. Start (httpd mode)
Please `start_web()` in public/index.php Add the following code before calling the function:
```php
//Start rewriting:
router_setup_rewrite_mapping($mapping);
start_web();
```

## 4. Start (CLI mode)

Please add the following code before the script starts executing logic:

```php
//Binding url rewriting
rewrite_bind_url($mapping);
```
